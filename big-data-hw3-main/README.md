# Анализ Рыночных Цен Автомобилей с Построчной Обработкой и Анализом в Hive

__Цель:__

Создать программу на Python для анализа средних рыночных цен на автомобили различных марок с последующей обработкой данных в Apache Hive для определения самой дорогой и самой дешевой марки автомобиля. 

__Датасет:__ 

Используйте доступный на Kaggle датасет, включающий марку, модель, цену и другие характеристики автомобилей [](https://www.kaggle.com/datasets/CooperUnion/cardataset) .

__Основные Задачи:__

Загрузка Данных: Автоматическая загрузка датасета, если он отсутствует

__Построчная Обработка Данных:__

Используйте map и reduce для обработки данных из CSV-файла построчно.

mapper: извлекает марку и цену из каждой строки.

reducer: накапливает данные по маркам и ценам.

__Анализ Данных:__

Вычисление средней цены для каждой марки.

__Сохранение Результатов:__

Сохраните результаты в новый CSV-файл.

__Обработка Данных в Hive:__

Загрузите полученный CSV-файл в таблицу Hive.

Используйте HiveQL для анализа данных и нахождения самой дорогой и самой дешевой марки автомобиля.

__Дополнительные Условия:__

Построчная Обработка: Эффективная обработка больших объемов данных.

Интеграция с Hive: Умение работать с Big Data и проводить аналитические запросы.

Результат: Скрипт Python для определения средних цен автомобилей, сохранение результатов в формате CSV, последующая обработка данных в Hive и вывод самой дорогой и самой дешевой марки автомобиля.

## Решение:

Программа на Python: `homework3.ipynb`

Расчеты в Hive:

- загрузка данных:

```
CREATE TABLE car_prices(id INT, mark STRING, price INT) ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' STORED AS TEXTFILE;
LOAD DATA INPATH '/car_prices.csv' INTO TABLE car_prices;
```
- вычисление самой дорогой марки автомобиля:

```
SELECT car_prices.mark, AVG(car_prices.price) AS avgp 
FROM car_prices GROUP BY car_prices.mark
ORDER BY avgp DESC LIMIT 1;
```
- вычисление самой дешевой марки автомобиля:

```
SELECT car_prices.mark, AVG(car_prices.price) AS avgp 
FROM car_prices GROUP BY car_prices.mark
ORDER BY avgp ASC LIMIT 1;
```

Результаты расчетов в Hive (скриншот): `hive-screenshot.png`

Результаты расчетов в Hive совпадают с результатами на Python.

